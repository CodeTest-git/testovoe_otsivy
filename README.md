# Yandex Maps Insights

Веб-приложение для сбора и отображения отзывов, рейтинга и фотографий организаций из Яндекс Карт.

![Laravel](https://img.shields.io/badge/Laravel-12-FF2D20?logo=laravel&logoColor=white)
![Vue.js](https://img.shields.io/badge/Vue.js-3-4FC08D?logo=vuedotjs&logoColor=white)
![Tailwind CSS](https://img.shields.io/badge/Tailwind_CSS-4-06B6D4?logo=tailwindcss&logoColor=white)
![PHP](https://img.shields.io/badge/PHP-≥8.2-777BB4?logo=php&logoColor=white)

---

## Содержание

- [Возможности](#возможности)
- [Стек технологий](#стек-технологий)
- [Требования](#требования)
- [Установка](#установка)
- [Переменные окружения](#переменные-окружения)
- [Использование](#использование)
  - [Какие ссылки вставлять](#какие-ссылки-вставлять)
  - [Работа с отзывами](#работа-с-отзывами)
- [Структура проекта](#структура-проекта)
- [Деплой на хостинг](#деплой-на-хостинг)

---

## Возможности

| Функция | Описание |
|---|---|
| **Авторизация** | Регистрация и вход по email/паролю с поддержкой 2FA |
| **Интеграция с Яндекс Картами** | Вставьте ссылку — система автоматически извлечёт данные |
| **Отзывы** | Все отзывы из карточки организации с именем, аватаром и статусом автора |
| **Рейтинг** | Общий рейтинг компании и индивидуальные оценки по каждому отзыву |
| **Фотографии** | До 5 фотографий организации с просмотром в полном размере |
| **Логотип** | Автоматическое определение и отображение аватарки организации |
| **Пагинация** | 5 отзывов на страницу с навигацией |
| **Фильтрация** | По рейтингу (1–5 звёзд) и сортировка по дате |
| **Подгрузка** | Кнопка «Загрузить ещё» для получения дополнительных отзывов |
| **Кэширование** | Результаты кэшируются на 30 минут для быстрой работы |
| **Тёмная тема** | Переключение между светлой и тёмной темой |

---

## Стек технологий

**Backend:** Laravel 12, PHP 8.2+, Fortify (аутентификация)

**Frontend:** Vue 3, Inertia.js, Tailwind CSS 4, Shadcn-vue (UI-компоненты), Lucide (иконки)

**Сборка:** Vite 5

**БД:** SQLite (разработка) / MySQL (продакшен)

---

## Требования

- PHP ≥ 8.2
- Composer ≥ 2.x
- Node.js ≥ 18.x
- npm ≥ 9.x

---

## Установка

```bash
# 1. Клонировать репозиторий
git clone https://github.com/CodeTest-git/testovoe_otsivy.git
cd testovoe_otsivy

# 2. Установить PHP-зависимости
composer install

# 3. Скопировать конфигурацию
cp .env.example .env

# 4. Сгенерировать ключ приложения
php artisan key:generate

# 5. Создать базу данных (SQLite)
touch database/database.sqlite

# 6. Выполнить миграции
php artisan migrate

# 7. Установить JS-зависимости
npm install

# 8. Собрать фронтенд
npm run build

# 9. Запустить сервер разработки
composer dev
```

> После запуска приложение доступно по адресу **http://localhost:8000**

---

## Переменные окружения

В файле `.env` необходимо указать:

| Переменная | Описание | Пример |
|---|---|---|
| `APP_URL` | URL приложения | `http://localhost:8000` |
| `DB_CONNECTION` | Драйвер БД | `sqlite` или `mysql` |
| `DB_DATABASE` | Путь/имя БД | `database/database.sqlite` |
| `YANDEX_MAPS_API_KEY` | API-ключ Яндекс Карт | `a08148f5-...` |

### Получение API-ключа Яндекс Карт

1. Перейдите в [Кабинет разработчика Яндекс](https://developer.tech.yandex.ru/)
2. Создайте новый ключ для **JavaScript API и HTTP Геокодер**
3. Скопируйте ключ в переменную `YANDEX_MAPS_API_KEY`

---

## Использование

### Какие ссылки вставлять

После авторизации откройте раздел **«Отзывы»** в боковом меню и вставьте ссылку на организацию из Яндекс Карт.

**Поддерживаемые форматы ссылок:**

1. **Прямая ссылка на организацию** — самый простой формат:

   ```
   https://yandex.ru/maps/org/название/1234567890/
   ```

2. **Ссылка из адресной строки** — когда вы открыли карточку заведения на карте:

   ```
   https://yandex.ru/maps/213/moscow/?ll=37.583207%2C55.766521&mode=poi&poi%5Buri%5D=ymapsbm1%3A%2F%2Forg%3Foid%3D87407731459&z=15
   ```

3. **Ссылка на страницу отзывов**:

   ```
   https://yandex.ru/maps/org/название/1234567890/reviews/
   ```

**Как скопировать ссылку:**

1. Откройте [Яндекс Карты](https://yandex.ru/maps/)
2. Найдите нужное заведение
3. Нажмите на карточку заведения
4. Скопируйте URL из адресной строки браузера
5. Вставьте в поле на странице «Отзывы»

### Работа с отзывами

- **Фильтр по рейтингу** — выберите количество звёзд, чтобы отобразить только отзывы с определённой оценкой
- **Сортировка по дате** — от новых к старым или наоборот
- **Загрузить ещё** — когда доходите до конца загруженных отзывов, нажмите кнопку для подгрузки следующей порции
- **Обновить данные** — нажмите кнопку обновления (↻), чтобы очистить кэш и загрузить свежие данные

---

## Структура проекта

```
testovoe_otsivy/
├── app/
│   ├── Http/Controllers/
│   │   └── YandexIntegrationController.php   # Контроллер интеграции
│   └── Services/
│       └── YandexReviewsService.php          # Сервис парсинга Яндекс Карт
├── config/
│   └── services.php                          # Конфигурация API-ключей
├── database/
│   └── migrations/                           # Миграции БД
├── resources/js/
│   ├── pages/
│   │   ├── Welcome.vue                       # Главная страница (лендинг)
│   │   └── yandex/
│   │       └── Integration.vue               # Страница отзывов
│   ├── components/
│   │   └── AppSidebar.vue                    # Боковая панель навигации
│   └── composables/
│       └── useAppearance.ts                  # Переключение темы
├── routes/
│   └── web.php                               # Маршруты приложения
└── public/
    └── build/                                # Скомпилированный фронтенд
```

---

## Деплой на хостинг

### Подготовка

```bash
# Убедитесь, что фронтенд собран
npm run build
```

### На сервере

```bash
# Установить зависимости (без dev-пакетов)
composer install --no-dev --optimize-autoloader

# Настроить .env (DB_CONNECTION=mysql, APP_DEBUG=false, ...)
nano .env

# Сгенерировать ключ
php artisan key:generate

# Запустить миграции
php artisan migrate --force

# Кэширование для production
php artisan config:cache
php artisan route:cache
php artisan view:cache

# Права на запись
chmod -R 775 storage bootstrap/cache
```

> **Document Root** веб-сервера должен указывать на папку `public/`.

---

## Лицензия

MIT
